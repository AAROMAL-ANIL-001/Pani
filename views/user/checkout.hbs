
<section>
			<div class="container mt-5">
				<form action="" id="place-order">
					<div class="row">
						<div class="col-md-6">
							<h2>Enter Delivery Address</h2><br>
							<div>
								<label for="">Address</label>
								<input class="form-control" type="text" id="address" name="address">
								<label for="">City</label>
								<input class="form-control" type="text" id="city" name="city">
								<label for="">State</label>
								<input class="form-control" type="text" id="state" name="state">
								<label for="">Pincode</label>
								<input class="form-control" type="text" id="pincode" name="pincode">
								<label for="">Mobile</label>
								<input class="form-control" type="text" id="mobile" name="mobile">
								<input type="text" name="userId" id="" value="{{user._id}}" hidden>
							</div>
						</div>
						<div class="col-md-4">
							<div class="container mt-5 ml-5 checkout">
								<h5>Total Amount:Rs.</h5>
								<h5 id="discountTotal">{{total}}</h5>
								<hr>
								<div class="payment">
									<p>Payment Method</p>
									<label class="radio-inline m-3">
										<input type="radio" name="payment-method" value="COD" checked> COD
									</label>
									<label class="radio-inline mt-2 m-3 ">
										<input type="radio" name="payment-method" value="ONLINE"> Online payment
									</label>
									<button class="btn btn-primary float-right mt-4" type="submit">Place Order</button>
								</div>
								
							</div>
							
						</div>
						
					</div>

				</form>
			</div>
</section>  


<!-- app -->
<div id="app">
    <!-- Header -->
    <header>
       
        
        

    </header>
    <!-- Header /- -->

    <!-- Checkout-Page -->
    <div class="page-checkout u-s-p-t-80">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 col-md-12">
                    
                    <!-- Second Accordion -->
                    <div>
						<form action="" id="coupon-form"
				 method="post">
                        <div class="message-open u-s-m-b-24">
                            Have a coupon?
                            <strong>
                                <a id="errMsg" class="u-c-brand" data-toggle="collapse" href="#showcoupon">Click here to enter your code</a>
                            </strong>
                        </div>
                        <div class="collapse u-s-m-b-24" id="showcoupon">
                            <h6 class="collapse-h6">
                                Enter your coupon code if you have one.
                            </h6>
                            <div class="coupon-field">
                                <label class="sr-only" for="coupon-code">Apply Coupon</label>
                                <input id="coupon" name="coupon"  type="text" class="text-field" placeholder="Coupon Code">
								<input  name="userId"  value="{{user._id}}" type="text" class="text-field" placeholder="Coupon Code"hidden >
                                <button type="submit" class="button">Apply Coupon</button>
								
                            </div>
                        </div>
						</form>
                    </div>
                    <!-- Second Accordion /- -->
                    {{!-- <form action="" id="place-order">
                        <div class="row">
                            <!-- Billing-&-Shipping-Details -->
                            <div class="col-lg-6">
                                <h4 class="section-h4">Billing Details</h4>
                                <!-- Form-Fields -->
                                <div class="group-inline u-s-m-b-13">
                                    <div class="group-1 u-s-p-r-16">
                                        <label for="first-name">Name
                                            <span class="astk">*</span>
                                        </label>
                                        <input type="text" id="first-name"name="name" class="text-field">
                                    </div>
                                   
                                </div>
                                
                                <div class="street-address u-s-m-b-13">
                                    <label for="req-st-address">Street Address
                                        <span class="astk">*</span>
                                    </label>
                                    <input type="text" id="req-st-address" name="address"class="text-field" placeholder="House name and street name">

                                    
                                </div>
                                <div class="u-s-m-b-13">
                                    <label for="town-city"> City
                                        <span class="astk">*</span>
                                    </label>
                                    <input type="text" id="town-city" name="city" class="text-field">
                                </div>
                                <div class="u-s-m-b-13">
                                    <label for="select-state">State 
                                        <span class="astk"> *</span>
                                    </label>
                                     <input type="text" id="town-city" name="state" class="text-field">
                                </div>
                                <div class="u-s-m-b-13">
                                    <label for="postcode">Postcode / Zip
                                        <span class="astk">*</span>
                                    </label>
                                    <input type="text" id="postcode" name="pincode" class="text-field">
                                </div>
                                <div class="group-inline u-s-m-b-13">
                                    
                                    <div class="group-2">
                                        <label for="phone">Phone
                                            <span class="astk">*</span>
                                        </label>
                                        <input type="text" id="phone" name="mobile" class="text-field">
                                    </div>
                                </div>
                               
                                
                                </div>
                               
                           
                            <!-- Billing-&-Shipping-Details /- -->
                            <!-- Checkout -->
                            <div class="col-lg-6">
                                <h4 class="section-h4">Your Order</h4>
                                <div class="order-table">
                                    <table class="u-s-m-b-13">
                                        <thead>
                                            <tr>
                                                <th>Product</th>
                                                <th>Total</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            
                                            <tr>
                                                <td>
                                                    <h3 class="order-h3">Total</h3>
                                                </td>
                                                <td>
                                                    <h3 class="order-h3">{{total}}</h3>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <div class="u-s-m-b-13">
                                        <input type="radio" class="radio-box" name="payment-method" value="COD" id="cash-on-delivery">
                                        <label class="label-text" for="cash-on-delivery">Cash on Delivery</label>
                                    </div>
                                 
                                    <div class="u-s-m-b-13">
                                        <input type="radio" class="radio-box" name="payment-method" value="ONLINE" id="paypal">
                                        <label class="label-text" for="paypal">Razorpay</label>
                                    </div>
                                    <div class="u-s-m-b-13">
                                        <input type="checkbox" class="check-box" id="accept">
                                        <label class="label-text no-color" for="accept">Iâ€™ve read and accept the
                                            <a href="terms-and-conditions.html" class="u-c-brand">terms & conditions</a>
                                        </label>
                                    </div>
                                    
									<button class="btn btn-primary float-right mt-4" type="submit">Place Order</button>
                                </div>
                            </div>
                            <!-- Checkout /- -->
                        </div>
                    </form> --}}
                </div>
            </div>
        </div>
    </div>
    <!-- Checkout-Page /- -->
    <!-- Footer -->
    {{!-- <footer class="footer">
        <div class="container">
            <!-- Outer-Footer -->
            <div class="outer-footer-wrapper u-s-p-y-80">
                <h6>
                    For special offers and other discount information
                </h6>
                <h1>
                    Subscribe to our Newsletter
                </h1>
                <p>
                    Subscribe to the mailing list to receive updates on promotions, new arrivals, discount and coupons.
                </p>
                <form class="newsletter-form">
                    <label class="sr-only" for="newsletter-field">Enter your Email</label>
                    <input type="text" id="newsletter-field" placeholder="Your Email Address">
                    <button type="submit" class="button">SUBMIT</button>
                </form>
            </div>
            <!-- Outer-Footer /- -->
            <!-- Mid-Footer -->
            {{!-- <div class="mid-footer-wrapper u-s-p-b-80">
                <div class="row">
                    <div class="col-lg-3 col-md-3 col-sm-12">
                        <div class="footer-list">
                            <h6>CUSTOMER SERVICE</h6>
                            <ul>
                                <li>
                                    <a href="faq.html">FAQs</a>
                                </li>
                                <li>
                                    <a href="track-order.html">Track Order</a>
                                </li>
                                <li>
                                    <a href="terms-and-conditions.html">Terms & Conditions</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-12">
                        <div class="footer-list">
                            <h6>COMPANY</h6>
                            <ul>
                                <li>
                                    <a href="home.html">Home</a>
                                </li>
                                <li>
                                    <a href="about.html">About</a>
                                </li>
                                <li>
                                    <a href="contact.html">Contact</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-12">
                        <div class="footer-list">
                            <h6>INFORMATION</h6>
                            <ul>
                                <li>
                                    <a href="store-directory.html">Categories Directory</a>
                                </li>
                                <li>
                                    <a href="wishlist.html">My Wishlist</a>
                                </li>
                                <li>
                                    <a href="cart.html">My Cart</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-12">
                        <div class="footer-list">
                            <h6>Address</h6>
                            <ul>
                                <li>
                                    <i class="fas fa-location-arrow u-s-m-r-9"></i>
                                    <span>819 Sugar Camp Road, West Concord, MN 55985</span>
                                </li>
                                <li>
                                    <a href="tel:+923086561801">
                                        <i class="fas fa-phone u-s-m-r-9"></i>
                                        <span>+111-444-989</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="mailto:contact@domain.com">
                                        <i class="fas fa-envelope u-s-m-r-9"></i>
                                        <span>
                                            contact@domain.com</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div> --}}
            <!-- Mid-Footer /- -->
            <!-- Bottom-Footer -->
            <div class="bottom-footer-wrapper">
                <div class="social-media-wrapper">
                    <ul class="social-media-list">
                        <li>
                            <a href="#">
                                <i class="fab fa-facebook-f"></i>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fab fa-twitter"></i>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fab fa-google-plus-g"></i>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fas fa-rss"></i>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fab fa-pinterest"></i>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fab fa-linkedin-in"></i>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fab fa-youtube"></i>
                            </a>
                        </li>
                    </ul>
                </div>
                <p class="copyright-text">Copyright &copy; 2018
                    <a href="home.html">Groover</a> All Right Reserved
                </p>
            </div>
        </div>
        <!-- Bottom-Footer /- -->
    </footer> --}}
    <!-- Footer /- -->
    <!-- Dummy Selectbox -->
  
    <!-- Dummy Selectbox /- -->
    <!-- Responsive-Search -->
    
    <!-- Responsive-Search /- -->
</div>
<!-- app /- -->
<!--[if lte IE 9]>
<div class="app-issue">
    <div class="vertical-center">
        <div class="text-center">
            <h1>You are using an outdated browser.</h1>
            <span>This web app is not compatible with following browser. Please upgrade your browser to improve your security and experience.</span>
        </div>
    </div>
</div>
<style> #app {
    display: none;
} </style>
<![endif]-->
<!-- NoScript -->

<script>
    $('#coupon-form').submit((e)=>{
        e.preventDefault()
        $.ajax({
            url:"/coupon-check",
            method:"POST",
            data:$('#coupon-form').serialize(),
            success:(response) =>{
      if(response.status){
        document.getElementById('errMsg').innerHTML=response.errMsg
      }else if(response.code){
        document.getElementById('errMsg').innerHTML=response.errMsg
      }else if(response.discountAdded){
        document.getElementById('errMsg').innerHTML=response.errMsg
        document.getElementById('discountTotal').innerHTML=response.discountAdded
        document.getElementById('discount').innerHTML=response.discount
        console.log(response.discountAdded);
      }else if(response.value){
        document.getElementById('errMsg').innerHTML=response.errMsg
       
      }
    }

        })
    })
</script>

    



		<script>
			$("#place-order").submit((e)=>{
				e.preventDefault()
				$.ajax({
					url:'/checkout',
					method:'post',
					data:$('#place-order').serialize(),
					success:(response)=>{
						if(response.codSuccess){
							location.href='/order-success'
						}else{
                        razorpayPayment(response)
						}
					}
				})
			})
			function razorpayPayment(order){
				var options =   {
						"key": "rzp_test_KeIppwor5rnfHK", // Enter the Key ID generated from the Dashboard
						"amount": order.amount, // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
						"currency": "INR",
						"name": "Infinity",
						"description": "Test Transaction",
						"image": "https://example.com/your_logo",
						"order_id": order.id, //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
						"handler": function (response){
							//alert(response.razorpay_payment_id);
							//alert(response.razorpay_order_id);
							//alert(response.razorpay_signature)

							verifyPayment(response,order)
						},
						"prefill": {
							"name": "Gaurav Kumar",
							"email": "gaurav.kumar@example.com",
							"contact": "9999999999"
						},
						"notes": {
							"address": "Razorpay Corporate Office"
						},
						"theme": {
							"color": "#3399cc"
						}
                     };
					 var rzp1 = new Razorpay(options);
					 rzp1.open()
			}
			function verifyPayment(payment,order){
				$.ajax({
					url:'/verify-payment',
					data:{
						payment,
						order
					},
					method:'post',
					success:(response)=>{
						if(response.status){
							location.href='/order-success'
						}else{
							alert("Payment failed")
						}
					}
				})
			}
		</script>

		<style>
			input[type=radio]{
				width:20px;
				height:20px;
			}
			label.radio-inline{
				display:flex;
				align-items: center;
			}
			.checkout{
				border:1px solid;
				border-radius:3px;
				padding:30px;
			}
			.payment{
				padding-bottom:16px;
			}
		</style>

